<html>
<head>
	<title>Whack-A-Mole</title>
	<link rel="stylesheet" type="text/css" href="whack-a-mole.css">
</head>
<body>
	<button id = "startGame" type="button" class="btn btn-primary btn-lg btn-block">Start Game</button>
	<h1>Whack-A-<strong>Shia Labeouf</strong></h1>
	<div id="wholeBody">
		<h3 class="timer">Timer: </h3>
		<h3 class="highScore"></h3>
		<div id = "body">
			<div class="squares" id="0"></div>
			<div class="squares" id="1"></div>
			<div class="squares" id="2"></div>
			<div class="squares" id="3"></div>
			<div class="squares" id="4"></div>
			<div class="squares" id="5"></div>
			<div class="squares" id="6"></div>
			<div class="squares" id="7"></div>
			<div class="squares" id="8"></div>
		</div>
		<p id="shia-video"></p>
	</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
	<script>
	"use strict";
		var holes = [0,1,2,3,4,5,6,7,8];
		var randomSquare;
		var clicked = 0;
		var konamiArray = [38,38,40,40,37,39,37,39,66,65,13];
		var incKonami = 0;
		var highScore = 0;
		var time = 0;

		$("#startGame").one("click" , function () {
			//Gets a random box to use with my shia
			function pickRandomSquare () {
				var squaresRef = $(".squares");
				randomSquare = Math.floor(Math.random() * holes.length);
				randomSquare = "#" + randomSquare;
				console.log(randomSquare);
			}

			//Animate shia to pop up with the picked random square
			function animateGuy () {
				pickRandomSquare();
				$(randomSquare).addClass("mole");
				$(".mole").css("visibility" , "visible");
				logClick();
	
				setTimeout(function () { 	//Timeout function to disapear shia after a set amount of time
					$(".mole").off('click');
					$(randomSquare).removeClass("mole");
				}, 610);
			}

			//changeHoles() will display another shia after a set amount of time
			function changeHoles() {
				setInterval(function () {
					animateGuy();
				}, 650);			
			}

			//logClick() is my click listener on my shia object 
			function logClick () {
				$(".mole").click(function () {
					var test = clicked;
					clicked++;
					if(clicked < 0) {
						clicked = 0;
					}
					$("#startGame").text("Score: " + clicked);
					if(test != clicked) {
						$(".mole").off('click');
					}
					$(randomSquare).removeClass("mole");
				});
			}	

			//resets the game after 30 sec
			function resetGame () {
				$("#startGame").text("New game");
				alert("Game over score of: " + clicked);
				$(".highScore").html("Highscore: " + highScore)
				clicked = 0;
				time = 0;	
			}

			function interval () {
				time++;
				$(".timer").html("Timer: " + time);
				if(time == 30){
					if(clicked > highScore) {
						highScore = clicked;
					}
					resetGame();
				}
			}
			//Calls interval function which gives the page a timer
			setInterval(interval,1000);
			
			changeHoles();
			$("#startGame").on("click" , function () {
				changeHoles();
			});
			
			//This reads for the user to enter the konami code if entered plays shia labeouf song on loop forever
			$(document).keyup(function(event){
				var konamiValue = event.keyCode;
				if (konamiValue == konamiArray[incKonami++]) {
					if(incKonami == konamiArray.length) {
						$("#wholeBody").css("background-image" , "url('holes.jpg')");
						$("#wholeBody").css("background-size" , "650px 650px");
						$("#shia-video").append("<iframe width='1' height='1' src='https://www.youtube.com/embed/o0u4M6vppCI?rel=0&autoplay=1&amp;loop=1&amp;' frameborder='0' allowfullscreen></iframe>");
					}
				} else {
					incKonami = 0;
				}
			});
		});

	</script>
</body>
</html>